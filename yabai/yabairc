#!/usr/bin/env sh

# Yabai â€” BSP tiling window manager
# Zero animation, performance-first

# Load scripting addition (requires SIP partially disabled)
yabai -m signal --add event=dock_did_restart action="sudo yabai --load-sa"
sudo yabai --load-sa

# ============================================================================
# GLOBAL SETTINGS
# ============================================================================

# Layout: BSP (binary space partitioning, like Hyprland dwindle)
yabai -m config layout bsp

# Gaps and padding (matching reference: gaps_in=5, gaps_out=10)
yabai -m config top_padding    36  # 26px bar + 10px outer gap
yabai -m config bottom_padding 10
yabai -m config left_padding   10
yabai -m config right_padding  10
yabai -m config window_gap      5

# Performance: zero animation, zero visual effects
yabai -m config window_animation_duration   0
yabai -m config window_shadow               off
yabai -m config window_opacity              off
yabai -m config insert_feedback_color       0xff9399b2

# Split
yabai -m config split_ratio          0.50
yabai -m config split_type           auto
yabai -m config auto_balance         off

# Mouse
yabai -m config mouse_follows_focus  on
yabai -m config focus_follows_mouse  off
yabai -m config mouse_modifier       alt
yabai -m config mouse_action1        move
yabai -m config mouse_action2        resize
yabai -m config mouse_drop_action    swap

# ============================================================================
# WINDOW RULES (float apps that shouldn't tile)
# ============================================================================

yabai -m rule --add app="^System Settings$"    manage=off
yabai -m rule --add app="^Calculator$"         manage=off
yabai -m rule --add app="^Sol$"                manage=off
yabai -m rule --add app="^1Password$"          manage=off
yabai -m rule --add app="^Activity Monitor$"   manage=off
yabai -m rule --add app="^Archive Utility$"    manage=off
yabai -m rule --add app="^Installer$"          manage=off
yabai -m rule --add app="^Karabiner"           manage=off
yabai -m rule --add app="^Alfred$"             manage=off
yabai -m rule --add app="^Raycast$"            manage=off
yabai -m rule --add app="^zoom.us$"            manage=off
yabai -m rule --add app="^FaceTime$"           manage=off
yabai -m rule --add app="^System Information$" manage=off
yabai -m rule --add app="^Font Book$"          manage=off
yabai -m rule --add app="^Finder$" title="(Copy|Bin|Preferences|Info)" manage=off

echo "yabai: config loaded"

{
  "$schema": "https://opencode.ai/config.json",
  "plugin": [
    "opencode-gemini-auth@latest",
    "@tarquinen/opencode-dcp@latest",
    "@nick-vi/opencode-type-inject@latest",
    "@franlol/opencode-md-table-formatter@latest"
  ],

  "model": "openai/gpt-5.3-codex",
  "small_model": "openai/gpt-5-mini",

  "theme": "opencode",
  "autoupdate": true,
  "share": "manual",

  "compaction": {
    "auto": true,
    "prune": true
  },

  "server": {
    "port": 4096,
    "hostname": "0.0.0.0"
  },

  "agent": {
    "build": {
      "mode": "primary",
      "model": "openai/gpt-5.3-codex",
      "variant": "high",
      "description": "Agent principal - implementation"
    },
    "plan": {
      "mode": "primary",
      "model": "kimi-for-coding/k2p5",
      "description": "Planification et analyse (etape 1 - K2.5)",
      "prompt": "Include in plan:\n- Goal: What we're building and why\n- Files to modify: List with rationale\n- Implementation steps: Ordered, with verification for each\n- Verification commands: Test commands and expected output\n- Risks: What could go wrong, rollback strategy\n- Dependencies: External deps, blockers\nWrite plan to ./PLAN.md. Do NOT write code yet. Iterate on plan until approved."
    },
    "plan_review": {
      "mode": "primary",
      "model": "openai/gpt-5.3-codex",
      "variant": "xhigh",
      "description": "Review de plan (etape 2 - Lead SWE)",
      "prompt": "Read ./PLAN.md as a staff engineer conducting design review.\nContext: git diff --stat HEAD~5..HEAD 2>/dev/null || echo 'No recent commits'\nFor each issue found:\n- Severity: blocking / important / suggestion\n- Description: Clear explanation of the concern\n- Recommended fix: Specific, actionable\nFocus areas:\n- Logic gaps and missed edge cases\n- Architectural concerns\n- Performance implications\n- Security vulnerabilities\n- Regression risks\n- Over-engineering (can it be simpler?)\n- Missing verification steps\nWrite review to ./REVIEW.md"
    }
  },

  "mcp": {
    "context7": {
      "type": "remote",
      "url": "https://mcp.context7.com/mcp",
      "enabled": true
    },
    "gh_grep": {
      "type": "remote",
      "url": "https://mcp.grep.app",
      "enabled": true
    },
    "github": {
      "type": "local",
      "command": ["npx", "-y", "@modelcontextprotocol/server-github"],
      "environment": {
        "GITHUB_PERSONAL_ACCESS_TOKEN": "{env:GITHUB_TOKEN}"
      },
      "enabled": true
    },
    "playwright": {
      "type": "local",
      "command": ["npx", "-y", "@playwright/mcp@latest"],
      "enabled": false
    },
    "pencil": {
      "type": "local",
      "command": [
        "/Applications/Pencil.app/Contents/Resources/app.asar.unpacked/out/mcp-server-darwin-arm64",
        "--app",
        "desktop"
      ],
      "enabled": true
    }
  },

  "permission": {
    "edit": "allow",
    "bash": "allow"
  },

  "command": {
    "test": {
      "template": "Run the test suite and fix failing tests.",
      "description": "Run tests"
    },
    "review": {
      "template": "Review changes for security and best practices. @review",
      "description": "Code review"
    }
  }
}
